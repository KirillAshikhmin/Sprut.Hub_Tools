# Выключить весь свет (Логический)
# Логический сценарий

## Выключает все лампы, выключатели и розетки в доме при включении выключателя или нажатии кнопки.

### Поддерживаемые типы устройств:
- **Лампы** (HS.Lightbulb) - всегда обрабатываются
- **Выключатели** (HS.Switch) - всегда обрабатываются  
- **Розетки** (HS.Outlet) - обрабатываются только при включенной опции

### Триггеры срабатывания:
- **Включение выключателя** (HS.Switch, HC.On = true)
- **Нажатие кнопки** (HS.StatelessProgrammableSwitch, HC.ProgrammableSwitchEvent)

### Настройки сценария:

#### 1. Исключить комнаты
- **Тип:** Строка
- **По умолчанию:** "Виртуальная"
- **Описание:** Названия комнат через запятую, где не надо выключать свет
- **Пример:** "Виртуальная, Серверная, Коридор"

#### 2. Исключить устройства
- **Тип:** Строка
- **По умолчанию:** "130, 188"
- **Описание:** ID устройств и сервисов через запятую
- **Поддерживаемые форматы:**
  - Целые числа: `130`, `188`
  - Строки: `"130"`, `"188"`
  - Дробные числа: `130.13` (аксессуар 130, сервис 13)
  - Строки с точкой: `"130.13"` (аксессуар 130, сервис 13)
- **Пример:** `130, "188", 200.15, "300.20"`

#### 3. Отключать скрытые
- **Тип:** Логическое значение
- **По умолчанию:** false
- **Описание:** Отключать скрытые устройства

#### 4. Отключать розетки
- **Тип:** Логическое значение
- **По умолчанию:** false
- **Описание:** Отключать розетки (по умолчанию выключено)
- **⚠️ Внимание:** По умолчанию розетки не отключаются, так как это может привести к неожиданному отключению важных устройств (холодильник, серверы и т.д.)

#### 5. Отладка
- **Тип:** Логическое значение
- **По умолчанию:** false
- **Описание:** Активация дополнительного логгирования для отладки

#### 6. Целевое устройство
- **Тип:** Выбор из списка
- **По умолчанию:** "Не выбрано"
- **Описание:** Выберите конкретное устройство для отключения (необязательно)
- **Примечание:** Если выбрано, будет отключаться только это устройство вместо всех

### Установка и настройка:

1. **Импорт сценария:**
   - Скопируйте содержимое файла `Выключить весь свет. Логический.json` в интерфейс хаба
   - Или импортируйте файл через интерфейс

2. **Настройка триггеров:**
   - Перейдите в "Настройки" → "Логика"
   - Найдите нужный выключатель или кнопку
   - Включите логический сценарий "Выключить весь свет (Логический)"
   - Настройте опции согласно вашим потребностям

3. **Настройка опций:**
   - **Исключить комнаты:** Укажите комнаты, где свет не должен выключаться
   - **Исключить устройства:** Укажите ID устройств и сервисов для исключения
   - **Отключать скрытые:** Включите, если нужно отключать скрытые устройства
   - **Отключать розетки:** Включите с осторожностью, если нужно отключать розетки
   - **Отладка:** Включите для диагностики работы сценария

### Примеры использования:

#### Пример 1: Простое использование
- Подключите к выключателю в прихожей
- При включении выключателя весь свет в доме выключится
- Исключения: комната "Виртуальная", устройства 130 и 188

#### Пример 2: С настройкой исключений
- **Исключить комнаты:** "Спальня, Детская"
- **Исключить устройства:** "130, 188.15, 200.5"
- **Отключать розетки:** false
- **Отладка:** true

#### Пример 3: Отключение только конкретного устройства
- **Целевое устройство:** "Люстра в гостиной"
- При срабатывании будет отключаться только выбранное устройство

### Переменные сценария:
- `lastTriggerTime` - время последнего срабатывания
- `triggerCount` - количество срабатываний

### Безопасность:
- Розетки по умолчанию не отключаются для предотвращения случайного отключения важных устройств
- Все настройки применяются индивидуально для каждого устройства-триггера
- Подробное логирование доступно через опцию "Отладка"

### Совместимость:
- Sprut.Hub с поддержкой логических сценариев
- JavaScript ES6 (ECMAScript 6)
- Nashorn движок
